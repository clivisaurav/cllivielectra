<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Archer Game</title>
  <style>
    body, html {
      margin: 0;
      padding: 0;
      overflow: hidden;
      height: 100%;
      display: flex;
      justify-content: center;
      align-items: center;
      background-color: #333;
    }

    canvas {
      border: 1px solid white;
    }

    #game-container {
      position: relative;
    }
  </style>
</head>
<body>
  <div id="game-container">
    <canvas id="gameCanvas"></canvas>
  </div>

  <script>
    // Canvas setup
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");

    canvas.width = 800;
    canvas.height = 600;

    // Game variables
    let archerX = 50;
    let archerY = canvas.height - 50;
    let arrows = [];
    let thieves = [];
    let ornament = { x: canvas.width / 2, y: canvas.height - 30, size: 20 };
    let health = 5;
    let score = 0;
    let gameOver = false;

    // Arrow and aiming variables
    let arrowSpeed = 5;
    let gravity = 0.1;
    let arrowPower = 0;
    let arrowAngle = Math.PI / 4;

    let isShooting = false;
    let mouseX = 0;
    let mouseY = 0;

    // Thieves creation
    function createThief() {
      const thief = {
        x: canvas.width,
        y: Math.random() * (canvas.height / 2),
        size: Math.random() * 20 + 20,
        speed: Math.random() * 1 + 0.5,
        bag: Math.random() > 0.5 ? 'black' : 'white'
      };
      thieves.push(thief);
    }

    // Draw elements
    function drawArcher() {
      ctx.beginPath();
      ctx.arc(archerX, archerY, 10, 0, 2 * Math.PI);
      ctx.fillStyle = 'black';
      ctx.fill();
      ctx.moveTo(archerX, archerY);
      ctx.lineTo(mouseX, mouseY);
      ctx.strokeStyle = 'white';
      ctx.stroke();
    }

    function drawArrow(arrow) {
      ctx.beginPath();
      ctx.moveTo(arrow.startX, arrow.startY);
      ctx.lineTo(arrow.x, arrow.y);
      ctx.strokeStyle = 'white';
      ctx.stroke();
    }

    function drawThieves() {
      thieves.forEach((thief, index) => {
        ctx.beginPath();
        ctx.arc(thief.x, thief.y, thief.size, 0, 2 * Math.PI);
        ctx.fillStyle = 'white';
        ctx.fill();
        // Draw thief's bag
        ctx.beginPath();
        ctx.arc(thief.x, thief.y, thief.size / 2, 0, 2 * Math.PI);
        ctx.fillStyle = thief.bag;
        ctx.fill();
        // Move thief towards the funnel
        thief.x -= thief.speed;
      });
    }

    function drawOrnament() {
      ctx.beginPath();
      ctx.moveTo(ornament.x, ornament.y);
      ctx.lineTo(ornament.x + ornament.size, ornament.y + ornament.size);
      ctx.lineTo(ornament.x - ornament.size, ornament.y + ornament.size);
      ctx.closePath();
      ctx.fillStyle = 'white';
      ctx.fill();
    }

    // Move arrows and check for collisions
    function moveArrows() {
      arrows.forEach((arrow, index) => {
        arrow.x += arrow.dx;
        arrow.y += arrow.dy;
        arrow.dy += gravity;

        thieves.forEach((thief, thiefIndex) => {
          const dist = Math.hypot(arrow.x - thief.x, arrow.y - thief.y);
          if (dist < thief.size) {
            thieves.splice(thiefIndex, 1);
            arrows.splice(index, 1);
            score += 10;
          }
        });

        if (arrow.x > canvas.width || arrow.y > canvas.height || arrow.y < 0 || arrow.x < 0) {
          arrows.splice(index, 1);
        }
      });
    }

    // Update the game
    function update() {
      if (gameOver) return;

      ctx.clearRect(0, 0, canvas.width, canvas.height);
      drawArcher();
      drawOrnament();
      drawThieves();
      moveArrows();

      thieves.forEach((thief, index) => {
        if (Math.hypot(thief.x - ornament.x, thief.y - ornament.y) < ornament.size) {
          thieves.splice(index, 1);
          health--;
        }
      });

      if (Math.random() < 0.01) {
        createThief();
      }

      ctx.fillStyle = 'white';
      ctx.font = '20px Arial';
      ctx.fillText('Health: ' + health, 10, 30);
      ctx.fillText('Score: ' + score, canvas.width - 100, 30);

      if (health <= 0) {
        gameOver = true;
        ctx.fillText('GAME OVER!', canvas.width / 2 - 100, canvas.height / 2);
      }

      requestAnimationFrame(update);
    }

    // Event listeners for aiming and shooting
    window.addEventListener('mousemove', (e) => {
      mouseX = e.clientX - canvas.offsetLeft;
      mouseY = e.clientY - canvas.offsetTop;
    });

    window.addEventListener('mousedown', () => {
      isShooting = true;
      arrowPower = 10;
    });

    window.addEventListener('mouseup', () => {
      if (isShooting) {
        const dx = (mouseX - archerX) / 10;
        const dy = (mouseY - archerY) / 10;

        arrows.push({
          startX: archerX,
          startY: archerY,
          x: archerX,
          y: archerY,
          dx: dx * arrowPower,
          dy: dy * arrowPower
        });

        isShooting = false;
      }
    });

    update();
  </script>
</body>
</html>
